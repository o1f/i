!function(s){"use strict";if(!(s.wbui||0)){var t,e,n,i,a,f=document,b="getElementsByClassName",p=function(t){return f.querySelectorAll(t)},r="OK",c="Cancel",v=["dialog","toast","loading","iframe"],o={type:0,mask:!0,maskClose:!0,closebtn:!0,whenBtnClickClose:!0,fixed:!0,anim:"def"},l={extend:function(t,e){var n="object"==typeof e?JSON.parse(JSON.stringify(e)):JSON.parse(JSON.stringify(o));for(var i in t)n[i]=t[i];return n},timer:{},end:{},touch:function(t,e){t.addEventListener("click",function(t){e.call(this,t)},!1)}},m=0,w=["wbui"],d=function(t){this.config=l.extend(t),this.view()};d.prototype.view=function(){var t=this,n=t.config,e=f.createElement("div"),i="object"==typeof n.content,a="string"==typeof n.type?n.type:w[0]+"-"+v[n.type||0];t.id=e.id=w[0]+m,e.setAttribute("class",w[0]+" "+a),e.setAttribute("index",m);var o,s,r=(o="object"==typeof n.title,n.title?'<h3 class="wbui-title'+(o?" "+n.title[1]:"")+'">'+(o?n.title[0]:n.title)+"</h3>":""),c=(s="object"==typeof n.closebtn,n.closebtn?'<a class="wbui-close'+(s?" "+n.closetype[1]:"")+'"><i></i></a>':""),l=function(){"string"==typeof n.btn&&(n.btn=[n.btn]);var t,e=(n.btn||[]).length;return 0!==e&&n.btn?(t='<span yes type="1">'+n.btn[0]+"</span>",2===e&&(t='<span no type="0">'+n.btn[1]+"</span>"+t),'<div class="wbui-btn">'+t+"</div>"):""}();if(n.fixed||(n.top=n.hasOwnProperty("top")?n.top:100,n.style=n.style||"",n.style+=" top:"+(f.body.scrollTop+n.top)+"px"),2===n.type&&(n.content='<i></i><i class="wbui-load"></i><i></i><p>'+(n.content||"")+"</p>"),3===n.type){n.content=i?n.content:[n.content||"","auto"];n.content='<iframe scrolling="'+(n.content[1]||"auto")+'" allowtransparency="true" id="'+v[3]+m+'" name="'+v[3]+m+'" onload="this.className=\'\';" class="wbui-load" frameborder="0" src="'+n.content[0]+'"></iframe>'}if(n.skin&&(n.anim="fade"),"msg"===n.skin&&(n.mask=n.closebtn=!1,n.time=2),e.innerHTML=(n.mask?"<div "+("string"==typeof n.mask?'style="'+n.mask+'"':"")+' class="wbui-mask"></div>':"")+'<div class="wbui-main" '+(n.fixed?"":'style="position:static;"')+'><div class="wbui-section"><div class="wbui-child '+(n.skin?"wbui-"+n.skin+" ":"")+(n.className?n.className:"")+" "+(n.anim?"wbui-anim-"+n.anim:"")+'" '+(n.style?'style="'+n.style+'"':"")+">"+r+'<div class="wbui-cont">'+n.content+"</div>"+l+(n.closebtn?c:"")+"</div></div></div>",!n.type||2===n.type){var d=f[b](w[0]+v[n.type]);1<=d.length&&wbui.close(d[0].getAttribute("index"))}document.body.appendChild(e);var u=t.elem=p("#"+t.id)[0];n.success&&n.success(u),t.index=m++,t.action(n,u)},d.prototype.action=function(t,e){var n=this;t.time&&(l.timer[n.index]=setTimeout(function(){wbui.close(n.index)},1e3*t.time));function i(){0==this.getAttribute("type")?(t.no&&t.no(),wbui.close(n.index)):(t.yes&&t.yes(n.index),t.whenBtnClickClose&&wbui.close(n.index))}if(t.btn)for(var a=e[b]("wbui-btn")[0].children,o=a.length,s=0;s<o;s++)l.touch(a[s],i);if(t.mask&&t.maskClose){var r=e[b]("wbui-mask")[0];l.touch(r,function(){wbui.close(n.index,t.end)})}if(t.closebtn){var c=e[b]("wbui-close")[0];l.touch(c,function(){wbui.close(n.index,t.end)})}t.end&&(l.end[n.index]=t.end)},s.wbui={v:"1.0.5",index:m,open:function(t){return new d(t||{}).index},alert:function(t,e){var n="function"==typeof e,i=l.extend({content:t,btn:r});return i=n?l.extend({yes:e},i):l.extend(e,i),s.wbui.open(i)},confirm:function(t,e,n,i){var a="function"==typeof e,o=l.extend({content:t,btn:[r,c]});return o=a?l.extend({yes:e,no:n},o):l.extend(e,o),s.wbui.open(o)},toast:function(t,e){var n="function"==typeof e,i=l.extend({type:1,content:t,mask:0,closebtn:0,time:2});return i=n?l.extend({end:e},i):l.extend(e,i),s.wbui.open(i)},loading:function(t){var e="function"==typeof t,n=l.extend({type:2,content:0,mask:0,maskClose:0,closebtn:0});return n=e?l.extend({end:t},n):l.extend(t,n),s.wbui.open(n)},iframe:function(t,e,n,i){var a="function"==typeof e,o=l.extend({type:3,content:t,mask:0});return o=a?l.extend({yes:e,no:n},o):l.extend(e,o),s.wbui.open(o)},close:function(t){var e=p("#"+w[0]+t)[0];e&&(e.innerHTML="",f.body.removeChild(e),clearTimeout(l.timer[t]),delete l.timer[t],"function"==typeof l.end[t]&&l.end[t](),delete l.end[t])},closeAll:function(){for(var t=f[b](w[0]),e=0,n=t.length;e<n;e++)wbui.close(0|t[0].getAttribute("index"))}},"function"==typeof define?define(function(){return wbui}):(e=document.scripts,n=e[e.length-1],i=n.src,a=i.substring(0,i.lastIndexOf("/")+1),n.getAttribute("assets")&&document.head.appendChild(((t=f.createElement("link")).href=a+"assets/wbui.css",t.type="text/css",t.rel="styleSheet",t.id="wbui_css",t)))}}(window),window.WB={smWidth:960,getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(e);return null!==n?unescape(n[2]):null},inViewport:function(t,e,n){var i,a,o,s,r;return a=t(window),i=e.getBoundingClientRect(),r=n||1,o=a.width(),s=a.height()*r,0<=i.bottom&&0<=i.right&&i.top<=s&&i.left<=o},Browser:{isMobile:/mobile/i.test(navigator.userAgent),isAndriod:/android/i.test(navigator.userAgent),isiOS:/iPhone|iPad|iPod/i.test(navigator.userAgent),isWeiXin:/MicroMessenger/i.test(navigator.userAgent)},lazyLoad:function(a,t){(t||a("[data-src]")).each(function(){var t,e=a(this),n=e.data("src"),i=e.data("srcset");e.is(":visible")&&(WB.inViewport(this,1.5)||e.hasClass("lin"))&&(e.is("img")?e.attr({src:n,srcset:i}):(t=new Image,a(t).load(function(){e.css({"background-image":"url("+n+")","background-size":"100% auto"})}),t.src=n),e.removeAttr("data-src"),e.removeAttr("data-srcset"),e.error(function(){var t=window._def_pic_url||window._wp_theme_uri+"/images/wbolt_def_cover.png";e.attr("src",t),console.log("error")}))})},localStorage:{set:function(t,e,n){window.localStorage&&localStorage.setItem(e,n)},get:function(t){return localStorage.getItem(t)}},scrollFixed:function(e,n,t){if(!n.length)return!1;t=t||{};var i,a,o=n.offset().top,s=n.width(),r=t.spTop||0,c=t.spBottom||100,l=t.ntoEle||".footer";n.attr("data-original-y",o),e(window).on("scroll",function(){if(a=e(window).width(),!(WB.isMobile||a<768)){var t=e(this).scrollTop();if(o<t)return n.css({position:"fixed",width:s}),(i=e(l).offset().top-n.height()-c)<=t?n.css("top",i-t):n.css("top",r),!1;WB.resetScrollFixed(n)}})},resetScrollFixed:function(t,e){e.css({position:"",width:"",top:""})},isSmWin:function(t,e){var n=e||this.smWidth;return t(window).width()<n?1:0},tabs:function(t,e,n){n=n||{};var i=e||t("#J_tabBox"),a=n.tabNav||i.find(".tab-nav-item,.tab-nav li"),o=n.tabCont||i.find(".tab-cont"),s=n.currClass||"current",r=n.tabEvent||WB.Browser.isMobile?"click":"mouseover",c=n.callBackFn,l=0;a.on(r,function(){l=t(this).index(),a.removeClass(s).eq(l).addClass(s),o.removeClass(s).eq(l).addClass(s),c&&c()})}},WB.Settings={init:function(t){var e=WB.Settings;e.leaveConfirm(t),e.typePreview(t),e.analytics(t),t("input.j-color-picker").wpColorPicker(),e.navTabs(t),e.ads(t),e.setAutoLoadPage(t),e.switchAction(t),e.uploadImg(t)},navTabs:function(n){if(0<n(".wbs-tabs").length){n(".group");var i=n(".wbs-tabs .tab-item"),t=0;"undefined"!=typeof localStorage&&(t=localStorage.getItem("active_tab")),n("#optionsframework-wrap .tab-content").eq(t).addClass("current").siblings(".tab-content").removeClass("current"),n("#optionsframework-wrap .tab-item").eq(t).addClass("current").siblings(".tab-item").removeClass("current"),i.on("click",function(t){t.preventDefault(),i.removeClass("current"),n(this).addClass("current").siblings(".tab-item").removeClass("current"),"undefined"!=typeof localStorage&&localStorage.setItem("active_tab",n(this).index());var e=n(this).attr("data-href");return n(e).addClass("current").siblings(".tab-content").removeClass("current"),!1})}},ads:function(n){function i(){n("#ggad_active").attr("value","0"),n("#wbs-group-ads .selector-bar .wbs-radio:checked").each(function(){var t=n(this);if(1==Number(t.val()))return n("#ggad_active").attr("value","1"),!1})}i(),n("#wbs-group-ads .selector-bar .wbs-radio").on("change",function(){var t=n(this),e=Number(t.val());t.parents(".j-ad-item").find(".default-hidden-box").removeClass("active"),0<e&&t.parents(".j-ad-item").find(".default-hidden-box").eq(e-1).addClass("active"),i()})},setIndexCate:{setCate:function(t,e){var n=e.val(),i=t("#flID"),a=i.val();e.is(":checked")?a=0<a.length?a+","+n:n:(","==(a=(","+a+",").replace(","+n+",",","))[0]&&(a=a.substring(1,a.length)),","==a[a.length-1]&&(a=a.substring(0,a.length-1))),i.val(a)},showCate:function(t){var n=t("#cat_list"),e=t("#flID").val();0<e.length&&e.split(",").forEach(function(t,e){n.find("input[value="+t+"]").attr("checked",!0)})}},setAutoLoadPage:function(t){t("#J_rangeAutoLoadRange").jRange({from:0,to:6,step:1,scale:["不限",1,2,3,4,5,6],showLabels:!1,snap:!0})},switchAction:function(n,t){(t||n(".wb-switch[data-target]")).on("change",function(){var t=n(this),e=n(t.data("target"));t.prop("checked")?(t.attr("data-value","true"),e.addClass("active")):(t.attr("data-value","false"),e.removeClass("active"))})},uploadImg:function(n,t,i){var a;(t||n(".section-upload .wbs-upload-btn")).click(function(t){var e=window.frame||window.wb_frame;a=i||n(this).prev("input"),e||(e=wp.media({title:"选择文件",button:{text:"确认"},multiple:!1}),(window.wb_frame=e).on("select",function(){var t=e.state().get("selection").toJSON()[0].url;a.val(t).focus()})),e.open()})},tagsModule:function(o,t){var e=t||o(".wb-tags-module"),i=e.find("[data-tags-value]"),s=e.find(".wb-tag-input"),n=e.find(".tag-items"),a=e.find(".count"),r=i.val(),c=!1,l=0;function d(t){r=""!=r?r+","+t:t,i.val(r)}function u(t){var e='<div class="tag-item"><span>'+t+' </span><a class="del" data-del-val="'+t+'"></a></div>';n.append(e)}function f(t){var e=t||r.length,n=i.data("max")||100;a.html("已输入<b>"+e+"</b>"),a[n<e?"addClass":"removeClass"]("hl")}f(),s.on("keydown blur paste",function(t){var e=t.keyCode||t.which||0,n=o(this);if(32===e?l++:l=0,"paste"!=t.type||c||(c=!0),"blur"===t.type||13===e||188===e||1<l){var i=o.trim(s.val());if(""==i)return!1;if(c){var a=i.split(",");0<a.length&&a.forEach(function(t){var e=o.trim(t);if(""==e)return!1;u(e),d(e)}),c=!1}else u(i),d(i);return n.val(""),f(),!1}if(8===e&&0===n.val().length)return n.val(""),!1}),e.on("click",".tag-item .del",function(){var t,e=o(this).parent(),n=o(this).attr("data-del-val");t=n,e.remove(),r=(r=(r=r.replace(t,"")).replace(/(^,)|(,$)/,"")).replace(/,,/,","),i.val(r),f()})},analytics:function(a){var o=a("[data-wba-source]").length&&a("[data-wba-source]").data("wba-source")||window.wbaSource||document.domain;a("a[data-wba-campaign]").each(function(){var t=a(this),e=t.data("wba-campaign"),n=t.data("wba-media")||"link",i=t.attr("href");i+=i.match("[?]")?"&":"?",i+="utm_source="+o,i+="&utm_media="+n,i+="&utm_campaign="+e,t.attr("href",i)})},typePreview:function(t){t("#J_typeItems .wbs-radio").on("change input",function(){0<t('input[name="wb_theme_cnf[donate][display_group]"]:checked').val()?t("#J_typePreview .btn-share").show():t("#J_typePreview .btn-share").hide()})},leaveConfirm:function(t){t("#optionsframework-wrap").find("input,textarea").on("change",function(){t(window).on("beforeunload",function(){return confirm("您修改的设置尚未保存，确定离开此页面吗？")}),t("#optionsframework-submit").addClass("sticky-bottom")}),t("#optionsframework-submit .wbs-btn-primary").on("click",function(){t(window).unbind("beforeunload")})}},WB.WBSettings={init:function(t){var e=WB.Settings;WB.WBSettings;e.init(t),2==localStorage.getItem("active_tab")&&e.bdChart(t),t("#J_addBtn").length&&t("#J_addBtn").on("click",function(){WB.Settings.uploadImg(t)})}},jQuery(function(t){WB.WBSettings.init(t)});